{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{120:function(e,t,n){\"use strict\";var o=n(3),a=n.n(o),r=n(5),i=n.n(r),s=n(15),l=n.n(s),u=n(6),c=n.n(u),p=n(9),d=n.n(p),f=n(0),h=n.n(f),m=n(1),y=n.n(m),v=n(7),g=n.n(v),b=n(2),k=n.n(b);function w(e){var t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch(e){return t}}function C(e){var t=new XMLHttpRequest;e.onProgress&&t.upload&&(t.upload.onprogress=function(t){t.total>0&&(t.percent=t.loaded/t.total*100),e.onProgress(t)});var n=new FormData;e.data&&Object.keys(e.data).forEach((function(t){n.append(t,e.data[t])})),n.append(e.filename,e.file),t.onerror=function(t){e.onError(t)},t.onload=function(){if(t.status<200||t.status>=300)return e.onError(function(e,t){var n=\"cannot \"+e.method+\" \"+e.action+\" \"+t.status+\"'\",o=new Error(n);return o.status=t.status,o.method=e.method,o.url=e.action,o}(e,t),w(t));e.onSuccess(w(t),t)},t.open(e.method,e.action,!0),e.withCredentials&&\"withCredentials\"in t&&(t.withCredentials=!0);var o=e.headers||{};for(var a in null!==o[\"X-Requested-With\"]&&t.setRequestHeader(\"X-Requested-With\",\"XMLHttpRequest\"),o)o.hasOwnProperty(a)&&null!==o[a]&&t.setRequestHeader(a,o[a]);return t.send(n),{abort:function(){t.abort()}}}var I=+new Date,D=0;function F(){return\"rc-upload-\"+I+\"-\"+ ++D}var O=function(e,t){if(e&&t){var n=Array.isArray(t)?t:t.split(\",\"),o=e.name||\"\",a=e.type||\"\",r=a.replace(/\\/.*$/,\"\");return n.some((function(e){var t,n,i=e.trim();return\".\"===i.charAt(0)?(t=o.toLowerCase(),n=i.toLowerCase(),-1!==t.indexOf(n,t.length-n.length)):/\\/\\*$/.test(i)?r===i.replace(/\\/.*$/,\"\"):a===i}))}return!0};var E=function(e,t,n){var o=function e(o,a){a=a||\"\",o.isFile?o.file((function(e){n(e)&&(o.fullPath&&!e.webkitRelativePath&&(Object.defineProperties(e,{webkitRelativePath:{writable:!0}}),e.webkitRelativePath=o.fullPath.replace(/^\\//,\"\"),Object.defineProperties(e,{webkitRelativePath:{writable:!1}})),t([e]))})):o.isDirectory&&function(e,t){var n=e.createReader(),o=[];!function e(){n.readEntries((function(n){var a=Array.prototype.slice.apply(n);o=o.concat(a),!a.length?t(o):e()}))}()}(o,(function(t){t.forEach((function(t){e(t,\"\"+a+o.name+\"/\")}))}))},a=!0,r=!1,i=void 0;try{for(var s,l=e[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){o(s.value.webkitGetAsEntry())}}catch(e){r=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(r)throw i}}},S=function(e){function t(){var e,n,o,a;i()(this,t);for(var r=arguments.length,s=Array(r),l=0;l<r;l++)s[l]=arguments[l];return n=o=c()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),o.state={uid:F()},o.reqs={},o.onChange=function(e){var t=e.target.files;o.uploadFiles(t),o.reset()},o.onClick=function(){var e=o.fileInput;e&&e.click()},o.onKeyDown=function(e){\"Enter\"===e.key&&o.onClick()},o.onFileDrop=function(e){var t=o.props.multiple;if(e.preventDefault(),\"dragover\"!==e.type)if(o.props.directory)E(e.dataTransfer.items,o.uploadFiles,(function(e){return O(e,o.props.accept)}));else{var n=Array.prototype.slice.call(e.dataTransfer.files).filter((function(e){return O(e,o.props.accept)}));!1===t&&(n=n.slice(0,1)),o.uploadFiles(n)}},o.uploadFiles=function(e){var t=Array.prototype.slice.call(e);t.map((function(e){return e.uid=F(),e})).forEach((function(e){o.upload(e,t)}))},o.saveFileInput=function(e){o.fileInput=e},a=n,c()(o,a)}return d()(t,e),l()(t,[{key:\"componentDidMount\",value:function(){this._isMounted=!0}},{key:\"componentWillUnmount\",value:function(){this._isMounted=!1,this.abort()}},{key:\"upload\",value:function(e,t){var n=this,o=this.props;if(!o.beforeUpload)return setTimeout((function(){return n.post(e)}),0);var a=o.beforeUpload(e,t);a&&a.then?a.then((function(t){var o=Object.prototype.toString.call(t);return\"[object File]\"===o||\"[object Blob]\"===o?n.post(t):n.post(e)})).catch((function(e){console&&console.log(e)})):!1!==a&&setTimeout((function(){return n.post(e)}),0)}},{key:\"post\",value:function(e){var t=this;if(this._isMounted){var n=this.props,o=n.data,a=n.onStart,r=n.onProgress,i=n.transformFile,s=void 0===i?function(e){return e}:i;new Promise((function(t){var o=n.action;if(\"function\"==typeof o)return t(o(e));t(o)})).then((function(i){var l=e.uid,u=n.customRequest||C;Promise.resolve(s(e)).catch((function(e){console.error(e)})).then((function(s){\"function\"==typeof o&&(o=o(e));var c={action:i,filename:n.name,data:o,file:s,headers:n.headers,withCredentials:n.withCredentials,method:n.method||\"post\",onProgress:r?function(t){r(t,e)}:null,onSuccess:function(o,a){delete t.reqs[l],n.onSuccess(o,e,a)},onError:function(o,a){delete t.reqs[l],n.onError(o,a,e)}};t.reqs[l]=u(c),a(e)}))}))}}},{key:\"reset\",value:function(){this.setState({uid:F()})}},{key:\"abort\",value:function(e){var t=this.reqs;if(e){var n=e;e&&e.uid&&(n=e.uid),t[n]&&t[n].abort&&t[n].abort(),delete t[n]}else Object.keys(t).forEach((function(e){t[e]&&t[e].abort&&t[e].abort(),delete t[e]}))}},{key:\"render\",value:function(){var e,t=this.props,n=t.component,o=t.prefixCls,r=t.className,i=t.disabled,s=t.id,l=t.style,u=t.multiple,c=t.accept,p=t.children,d=t.directory,f=t.openFileDialogOnClick,m=k()((e={},g()(e,o,!0),g()(e,o+\"-disabled\",i),g()(e,r,r),e)),y=i?{}:{onClick:f?this.onClick:function(){},onKeyDown:f?this.onKeyDown:function(){},onDrop:this.onFileDrop,onDragOver:this.onFileDrop,tabIndex:\"0\"};return h.a.createElement(n,a()({},y,{className:m,role:\"button\",style:l}),h.a.createElement(\"input\",{id:s,type:\"file\",ref:this.saveFileInput,onClick:function(e){return e.stopPropagation()},key:this.state.uid,style:{display:\"none\"},accept:c,directory:d?\"directory\":null,webkitdirectory:d?\"webkitdirectory\":null,multiple:u,onChange:this.onChange}),p)}}]),t}(f.Component);S.propTypes={id:y.a.string,component:y.a.string,style:y.a.object,prefixCls:y.a.string,className:y.a.string,multiple:y.a.bool,directory:y.a.bool,disabled:y.a.bool,accept:y.a.string,children:y.a.any,onStart:y.a.func,data:y.a.oneOfType([y.a.object,y.a.func]),action:y.a.oneOfType([y.a.string,y.a.func]),headers:y.a.object,beforeUpload:y.a.func,customRequest:y.a.func,onProgress:y.a.func,withCredentials:y.a.bool,openFileDialogOnClick:y.a.bool,transformFile:y.a.func};var P=S,N=n(4),R=n.n(N),U=n(31),T=n.n(U),j={position:\"absolute\",top:0,opacity:0,filter:\"alpha(opacity=0)\",left:0,zIndex:9999},x=function(e){function t(){var e,n,o,a;i()(this,t);for(var r=arguments.length,s=Array(r),l=0;l<r;l++)s[l]=arguments[l];return n=o=c()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),o.state={uploading:!1},o.file={},o.onLoad=function(){if(o.state.uploading){var e=o,t=e.props,n=e.file,a=void 0;try{var r=o.getIframeDocument(),i=r.getElementsByTagName(\"script\")[0];i&&i.parentNode===r.body&&r.body.removeChild(i),a=r.body.innerHTML,t.onSuccess(a,n)}catch(e){T()(!1,\"cross domain error for Upload. Maybe server should return document.domain script. see Note from https://github.com/react-component/upload\"),a=\"cross-domain\",t.onError(e,null,n)}o.endUpload()}},o.onChange=function(){var e=o.getFormInputNode(),t=o.file={uid:F(),name:e.value&&e.value.substring(e.value.lastIndexOf(\"\\\\\")+1,e.value.length)};o.startUpload();var n=o.props;if(!n.beforeUpload)return o.post(t);var a=n.beforeUpload(t);a&&a.then?a.then((function(){o.post(t)}),(function(){o.endUpload()})):!1!==a?o.post(t):o.endUpload()},o.saveIframe=function(e){o.iframe=e},a=n,c()(o,a)}return d()(t,e),l()(t,[{key:\"componentDidMount\",value:function(){this.updateIframeWH(),this.initIframe()}},{key:\"componentDidUpdate\",value:function(){this.updateIframeWH()}},{key:\"getIframeNode\",value:function(){return this.iframe}},{key:\"getIframeDocument\",value:function(){return this.getIframeNode().contentDocument}},{key:\"getFormNode\",value:function(){return this.getIframeDocument().getElementById(\"form\")}},{key:\"getFormInputNode\",value:function(){return this.getIframeDocument().getElementById(\"input\")}},{key:\"getFormDataNode\",value:function(){return this.getIframeDocument().getElementById(\"data\")}},{key:\"getFileForMultiple\",value:function(e){return this.props.multiple?[e]:e}},{key:\"getIframeHTML\",value:function(e){var t=\"\",n=\"\";if(e){t='<script>document.domain=\"'+e+'\";<\\/script>',n='<input name=\"_documentDomain\" value=\"'+e+'\" />'}return'\\n    <!DOCTYPE html>\\n    <html>\\n    <head>\\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\\n    <style>\\n    body,html {padding:0;margin:0;border:0;overflow:hidden;}\\n    </style>\\n    '+t+'\\n    </head>\\n    <body>\\n    <form method=\"post\"\\n    encType=\"multipart/form-data\"\\n    action=\"\" id=\"form\"\\n    style=\"display:block;height:9999px;position:relative;overflow:hidden;\">\\n    <input id=\"input\" type=\"file\"\\n     name=\"'+this.props.name+'\"\\n     style=\"position:absolute;top:0;right:0;height:9999px;font-size:9999px;cursor:pointer;\"/>\\n    '+n+'\\n    <span id=\"data\"></span>\\n    </form>\\n    </body>\\n    </html>\\n    '}},{key:\"initIframeSrc\",value:function(){this.domain&&(this.getIframeNode().src=\"javascript:void((function(){\\n        var d = document;\\n        d.open();\\n        d.domain='\"+this.domain+\"';\\n        d.write('');\\n        d.close();\\n      })())\")}},{key:\"initIframe\",value:function(){var e=this.getIframeNode(),t=e.contentWindow,n=void 0;this.domain=this.domain||\"\",this.initIframeSrc();try{n=t.document}catch(o){this.domain=document.domain,this.initIframeSrc(),n=(t=e.contentWindow).document}n.open(\"text/html\",\"replace\"),n.write(this.getIframeHTML(this.domain)),n.close(),this.getFormInputNode().onchange=this.onChange}},{key:\"endUpload\",value:function(){this.state.uploading&&(this.file={},this.state.uploading=!1,this.setState({uploading:!1}),this.initIframe())}},{key:\"startUpload\",value:function(){this.state.uploading||(this.state.uploading=!0,this.setState({uploading:!0}))}},{key:\"updateIframeWH\",value:function(){var e=R.a.findDOMNode(this),t=this.getIframeNode();t.style.height=e.offsetHeight+\"px\",t.style.width=e.offsetWidth+\"px\"}},{key:\"abort\",value:function(e){if(e){var t=e;e&&e.uid&&(t=e.uid),t===this.file.uid&&this.endUpload()}else this.endUpload()}},{key:\"post\",value:function(e){var t=this,n=this.getFormNode(),o=this.getFormDataNode(),a=this.props.data,r=this.props.onStart;\"function\"==typeof a&&(a=a(e));var i=document.createDocumentFragment();for(var s in a)if(a.hasOwnProperty(s)){var l=document.createElement(\"input\");l.setAttribute(\"name\",s),l.value=a[s],i.appendChild(l)}o.appendChild(i),new Promise((function(n){var o=t.props.action;if(\"function\"==typeof o)return n(o(e));n(o)})).then((function(t){n.setAttribute(\"action\",t),n.submit(),o.innerHTML=\"\",r(e)}))}},{key:\"render\",value:function(){var e,t=this.props,n=t.component,o=t.disabled,r=t.className,i=t.prefixCls,s=t.children,l=t.style,u=a()({},j,{display:this.state.uploading||o?\"none\":\"\"}),c=k()((e={},g()(e,i,!0),g()(e,i+\"-disabled\",o),g()(e,r,r),e));return h.a.createElement(n,{className:c,style:a()({position:\"relative\",zIndex:0},l)},h.a.createElement(\"iframe\",{ref:this.saveIframe,onLoad:this.onLoad,style:u}),s)}}]),t}(f.Component);x.propTypes={component:y.a.string,style:y.a.object,disabled:y.a.bool,prefixCls:y.a.string,className:y.a.string,accept:y.a.string,onStart:y.a.func,multiple:y.a.bool,children:y.a.any,data:y.a.oneOfType([y.a.object,y.a.func]),action:y.a.oneOfType([y.a.string,y.a.func]),name:y.a.string};var q=x;function _(){}var M=function(e){function t(){var e,n,o,a;i()(this,t);for(var r=arguments.length,s=Array(r),l=0;l<r;l++)s[l]=arguments[l];return n=o=c()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),o.state={Component:null},o.saveUploader=function(e){o.uploader=e},a=n,c()(o,a)}return d()(t,e),l()(t,[{key:\"componentDidMount\",value:function(){this.props.supportServerRender&&this.setState({Component:this.getComponent()},this.props.onReady)}},{key:\"getComponent\",value:function(){return\"undefined\"!=typeof File?P:q}},{key:\"abort\",value:function(e){this.uploader.abort(e)}},{key:\"render\",value:function(){if(this.props.supportServerRender){var e=this.state.Component;return e?h.a.createElement(e,a()({},this.props,{ref:this.saveUploader})):null}var t=this.getComponent();return h.a.createElement(t,a()({},this.props,{ref:this.saveUploader}))}}]),t}(f.Component);M.propTypes={component:y.a.string,style:y.a.object,prefixCls:y.a.string,action:y.a.oneOfType([y.a.string,y.a.func]),name:y.a.string,multipart:y.a.bool,directory:y.a.bool,onError:y.a.func,onSuccess:y.a.func,onProgress:y.a.func,onStart:y.a.func,data:y.a.oneOfType([y.a.object,y.a.func]),headers:y.a.object,accept:y.a.string,multiple:y.a.bool,disabled:y.a.bool,beforeUpload:y.a.func,customRequest:y.a.func,onReady:y.a.func,withCredentials:y.a.bool,supportServerRender:y.a.bool,openFileDialogOnClick:y.a.bool},M.defaultProps={component:\"span\",prefixCls:\"rc-upload\",data:{},headers:{},name:\"file\",multipart:!1,onReady:_,onStart:_,onError:_,onSuccess:_,supportServerRender:!1,multiple:!1,beforeUpload:null,customRequest:null,withCredentials:!1,openFileDialogOnClick:!0};var A=M;t.a=A}}]);","extractedComments":[]}